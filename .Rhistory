subset(!is.na(sick_note_1_date)) %>%
transmute( n_sick_note1 = n(),
notmiss_dur_days_1 = sum(!is.na(sick_note_1_duration_days)),
notmiss_dur_weeks_1 = sum(!is.na(sick_note_1_duration_weeks)),
notmiss_dur_mos_1 = sum(!is.na(sick_note_1_duration_months)),
group = name) %>%
distinct()
sicknote2  <- data %>%
subset(!is.na(sick_note_2_date)) %>%
transmute( n_sick_note2 = n(),
notmiss_dur_days_2 = sum(!is.na(sick_note_2_duration_days)),
notmiss_dur_weeks_2 = sum(!is.na(sick_note_2_duration_weeks)),
notmiss_dur_mos_2 = sum(!is.na(sick_note_2_duration_months)),
group = name) %>%
distinct()
sicknote3  <- data %>%
subset(!is.na(sick_note_3_date)) %>%
transmute( n_sick_note3 = n(),
notmiss_dur_days_3 = sum(!is.na(sick_note_3_duration_days)),
notmiss_dur_weeks_3 = sum(!is.na(sick_note_3_duration_weeks)),
notmiss_dur_mos_3=  sum(!is.na(sick_note_3_duration_months)),
group = name) %>%
sicknote4  <- data %>%
subset(!is.na(sick_note_4_date)) %>%
transmute( n_sick_note4 = n(),
notmiss_dur_days_4 = sum(!is.na(sick_note_4_duration_days)),
notmiss_dur_weeks_4 = sum(!is.na(sick_note_4_duration_weeks)),
notmiss_dur_mos_4 = sum(!is.na(sick_note_4_duration_months)),
group = name) %>%
sicknote5 <- data %>%
subset(!is.na(sick_note_5_date)) %>%
transmute( n_sick_note5 = n(),
notmiss_dur_days_5 = sum(!is.na(sick_note_5_duration_days)),
notmiss_dur_weeks_5 = sum(!is.na(sick_note_5_duration_weeks)),
notmiss_dur_mos_5 = sum(!is.na(sick_note_5_duration_months)),
group = name) %>%
sicknotes <- rbind(sicknote1, sicknote2, sicknote3, sicknote4, sicknote5)
return(sicknotes)
}
covid20 <- read_dta(here::here("output", "cohorts", "cohort_rates_covid_2020.dta"))
miss_covid20 <- miss_raw(covid20, "COVID2020")
library(data.table)
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
miss_raw <- function(data, name) {
sicknote1  <- data %>%
subset(!is.na(sick_note_1_date)) %>%
transmute( n_sick_note1 = n(),
notmiss_dur_days_1 = sum(!is.na(sick_note_1_duration_days)),
notmiss_dur_weeks_1 = sum(!is.na(sick_note_1_duration_weeks)),
notmiss_dur_mos_1 = sum(!is.na(sick_note_1_duration_months)),
group = name) %>%
distinct()
sicknote2  <- data %>%
subset(!is.na(sick_note_2_date)) %>%
transmute( n_sick_note2 = n(),
notmiss_dur_days_2 = sum(!is.na(sick_note_2_duration_days)),
notmiss_dur_weeks_2 = sum(!is.na(sick_note_2_duration_weeks)),
notmiss_dur_mos_2 = sum(!is.na(sick_note_2_duration_months)),
group = name) %>%
distinct()
sicknote3  <- data %>%
subset(!is.na(sick_note_3_date)) %>%
transmute( n_sick_note3 = n(),
notmiss_dur_days_3 = sum(!is.na(sick_note_3_duration_days)),
notmiss_dur_weeks_3 = sum(!is.na(sick_note_3_duration_weeks)),
notmiss_dur_mos_3=  sum(!is.na(sick_note_3_duration_months)),
group = name) %>%
sicknote4  <- data %>%
subset(!is.na(sick_note_4_date)) %>%
transmute( n_sick_note4 = n(),
notmiss_dur_days_4 = sum(!is.na(sick_note_4_duration_days)),
notmiss_dur_weeks_4 = sum(!is.na(sick_note_4_duration_weeks)),
notmiss_dur_mos_4 = sum(!is.na(sick_note_4_duration_months)),
group = name) %>%
sicknote5 <- data %>%
subset(!is.na(sick_note_5_date)) %>%
transmute( n_sick_note5 = n(),
notmiss_dur_days_5 = sum(!is.na(sick_note_5_duration_days)),
notmiss_dur_weeks_5 = sum(!is.na(sick_note_5_duration_weeks)),
notmiss_dur_mos_5 = sum(!is.na(sick_note_5_duration_months)),
group = name) %>%
sicknotes <- rbind(sicknote1, sicknote2, sicknote3, sicknote4, sicknote5)
return(sicknotes)
}
miss_covid20 <- miss_raw(covid20, "COVID2020")
miss_raw <- function(data, name) {
sicknote1  <- data %>%
subset(!is.na(sick_note_1_date)) %>%
transmute( n_sick_note1 = n(),
notmiss_dur_days_1 = sum(!is.na(sick_note_1_duration_days)),
notmiss_dur_weeks_1 = sum(!is.na(sick_note_1_duration_weeks)),
notmiss_dur_mos_1 = sum(!is.na(sick_note_1_duration_months)),
group = name) %>%
distinct()
sicknote2  <- data %>%
subset(!is.na(sick_note_2_date)) %>%
transmute( n_sick_note2 = n(),
notmiss_dur_days_2 = sum(!is.na(sick_note_2_duration_days)),
notmiss_dur_weeks_2 = sum(!is.na(sick_note_2_duration_weeks)),
notmiss_dur_mos_2 = sum(!is.na(sick_note_2_duration_months)),
group = name) %>%
distinct()
sicknote3  <- data %>%
subset(!is.na(sick_note_3_date)) %>%
transmute( n_sick_note3 = n(),
notmiss_dur_days_3 = sum(!is.na(sick_note_3_duration_days)),
notmiss_dur_weeks_3 = sum(!is.na(sick_note_3_duration_weeks)),
notmiss_dur_mos_3=  sum(!is.na(sick_note_3_duration_months)),
group = name) %>%
distinct()
sicknote4  <- data %>%
subset(!is.na(sick_note_4_date)) %>%
transmute( n_sick_note4 = n(),
notmiss_dur_days_4 = sum(!is.na(sick_note_4_duration_days)),
notmiss_dur_weeks_4 = sum(!is.na(sick_note_4_duration_weeks)),
notmiss_dur_mos_4 = sum(!is.na(sick_note_4_duration_months)),
group = name) %>%
distinct()
sicknote5 <- data %>%
subset(!is.na(sick_note_5_date)) %>%
transmute( n_sick_note5 = n(),
notmiss_dur_days_5 = sum(!is.na(sick_note_5_duration_days)),
notmiss_dur_weeks_5 = sum(!is.na(sick_note_5_duration_weeks)),
notmiss_dur_mos_5 = sum(!is.na(sick_note_5_duration_months)),
group = name) %>%
distinct()
sicknotes <- rbind(sicknote1, sicknote2, sicknote3, sicknote4, sicknote5)
return(sicknotes)
}
miss_covid20 <- miss_raw(covid20, "COVID2020")
###### Check original variables #######
library(data.table)
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
miss_raw <- function(data, name) {
sicknote1  <- data %>%
subset(!is.na(sick_note_1_date)) %>%
transmute( n_sick_note1 = n(),
notmiss_dur_days_1 = sum(!is.na(sick_note_1_duration_days)),
notmiss_dur_weeks_1 = sum(!is.na(sick_note_1_duration_weeks)),
notmiss_dur_mos_1 = sum(!is.na(sick_note_1_duration_months)),
group = name) %>%
distinct()
sicknote2  <- data %>%
subset(!is.na(sick_note_2_date)) %>%
transmute( n_sick_note2 = n(),
notmiss_dur_days_2 = sum(!is.na(sick_note_2_duration_days)),
notmiss_dur_weeks_2 = sum(!is.na(sick_note_2_duration_weeks)),
notmiss_dur_mos_2 = sum(!is.na(sick_note_2_duration_months)),
group = name) %>%
distinct()
sicknote3  <- data %>%
subset(!is.na(sick_note_3_date)) %>%
transmute( n_sick_note3 = n(),
notmiss_dur_days_3 = sum(!is.na(sick_note_3_duration_days)),
notmiss_dur_weeks_3 = sum(!is.na(sick_note_3_duration_weeks)),
notmiss_dur_mos_3=  sum(!is.na(sick_note_3_duration_months)),
group = name) %>%
distinct()
sicknote4  <- data %>%
subset(!is.na(sick_note_4_date)) %>%
transmute( n_sick_note4 = n(),
notmiss_dur_days_4 = sum(!is.na(sick_note_4_duration_days)),
notmiss_dur_weeks_4 = sum(!is.na(sick_note_4_duration_weeks)),
notmiss_dur_mos_4 = sum(!is.na(sick_note_4_duration_months)),
group = name) %>%
distinct()
sicknote5 <- data %>%
subset(!is.na(sick_note_5_date)) %>%
transmute( n_sick_note5 = n(),
notmiss_dur_days_5 = sum(!is.na(sick_note_5_duration_days)),
notmiss_dur_weeks_5 = sum(!is.na(sick_note_5_duration_weeks)),
notmiss_dur_mos_5 = sum(!is.na(sick_note_5_duration_months)),
group = name) %>%
distinct()
sicknotes <- cbind(sicknote1, sicknote2, sicknote3, sicknote4, sicknote5)
return(sicknotes)
}
miss_covid20 <- miss_raw(covid20, "COVID2020")
View(miss_covid20)
miss_raw <- function(data, name) {
sicknote1  <- data %>%
subset(!is.na(sick_note_1_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_1_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_1_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_1_duration_months)),
group = name, var = 1) %>%
distinct()
sicknote2  <- data %>%
subset(!is.na(sick_note_2_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_2_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_2_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_2_duration_months)),
var = 2) %>%
distinct()
sicknote3  <- data %>%
subset(!is.na(sick_note_3_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_3_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_3_duration_weeks)),
notmiss_dur_mos=  sum(!is.na(sick_note_3_duration_months)),
var = 3) %>%
distinct()
sicknote4  <- data %>%
subset(!is.na(sick_note_4_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_4_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_4_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_4_duration_months)),
var = 4) %>%
distinct()
sicknote5 <- data %>%
subset(!is.na(sick_note_5_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_5_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_5_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_5_duration_months)),
var = 5) %>%
distinct()
sicknotes <- cbind(sicknote1, sicknote2, sicknote3, sicknote4, sicknote5) %>%
mutate(pcent_dur_days = notmiss_dur_days / n_sick_note * 100,
pcent_dur_weeks = notmiss_dur_weeks / n_sick_note * 100,
pcent_dur_mos = notmiss_dur_mos / n_sick_note * 100)
return(sicknotes)
}
miss_covid20 <- miss_raw(covid20, "COVID2020")
miss_raw <- function(data, name) {
sicknote1  <- data %>%
subset(!is.na(sick_note_1_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_1_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_1_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_1_duration_months)),
group = name, var = 1) %>%
distinct()
sicknote2  <- data %>%
subset(!is.na(sick_note_2_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_2_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_2_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_2_duration_months)),
var = 2) %>%
distinct()
sicknote3  <- data %>%
subset(!is.na(sick_note_3_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_3_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_3_duration_weeks)),
notmiss_dur_mos=  sum(!is.na(sick_note_3_duration_months)),
var = 3) %>%
distinct()
sicknote4  <- data %>%
subset(!is.na(sick_note_4_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_4_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_4_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_4_duration_months)),
var = 4) %>%
distinct()
sicknote5 <- data %>%
subset(!is.na(sick_note_5_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_5_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_5_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_5_duration_months)),
var = 5) %>%
distinct()
sicknotes <- cbind(sicknote1, sicknote2, sicknote3, sicknote4, sicknote5) %>%
mutate(pcent_dur_days = notmiss_dur_days / n_sick_note * 100,
pcent_dur_weeks = notmiss_dur_weeks / n_sick_note * 100,
pcent_dur_mos = notmiss_dur_mos / n_sick_note * 100)
return(sicknotes)
}
miss_covid20 <- miss_raw(covid20, "COVID2020")
miss_raw <- function(data, name) {
sicknote1  <- data %>%
subset(!is.na(sick_note_1_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_1_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_1_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_1_duration_months)),
group = name, var = 1) %>%
distinct()
sicknote2  <- data %>%
subset(!is.na(sick_note_2_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_2_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_2_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_2_duration_months)),
var = 2) %>%
distinct()
sicknote3  <- data %>%
subset(!is.na(sick_note_3_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_3_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_3_duration_weeks)),
notmiss_dur_mos=  sum(!is.na(sick_note_3_duration_months)),
var = 3) %>%
distinct()
sicknote4  <- data %>%
subset(!is.na(sick_note_4_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_4_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_4_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_4_duration_months)),
var = 4) %>%
distinct()
sicknote5 <- data %>%
subset(!is.na(sick_note_5_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_5_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_5_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_5_duration_months)),
var = 5) %>%
distinct()
sicknotes <- rbind(sicknote1, sicknote2, sicknote3, sicknote4, sicknote5) %>%
mutate(pcent_dur_days = notmiss_dur_days / n_sick_note * 100,
pcent_dur_weeks = notmiss_dur_weeks / n_sick_note * 100,
pcent_dur_mos = notmiss_dur_mos / n_sick_note * 100)
return(sicknotes)
}
miss_covid20 <- miss_raw(covid20, "COVID2020")
miss_raw <- function(data, name) {
sicknote1  <- data %>%
subset(!is.na(sick_note_1_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_1_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_1_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_1_duration_months)),
group = name, var = 1) %>%
distinct()
sicknote2  <- data %>%
subset(!is.na(sick_note_2_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_2_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_2_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_2_duration_months)),
group = name, var = 2) %>%
distinct()
sicknote3  <- data %>%
subset(!is.na(sick_note_3_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_3_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_3_duration_weeks)),
notmiss_dur_mos=  sum(!is.na(sick_note_3_duration_months)),
group = name, var = 3) %>%
distinct()
sicknote4  <- data %>%
subset(!is.na(sick_note_4_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_4_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_4_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_4_duration_months)),
group = name, var = 4) %>%
distinct()
sicknote5 <- data %>%
subset(!is.na(sick_note_5_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_5_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_5_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_5_duration_months)),
group = name, var = 5) %>%
distinct()
sicknotes <- rbind(sicknote1, sicknote2, sicknote3, sicknote4, sicknote5) %>%
mutate(pcent_dur_days = notmiss_dur_days / n_sick_note * 100,
pcent_dur_weeks = notmiss_dur_weeks / n_sick_note * 100,
pcent_dur_mos = notmiss_dur_mos / n_sick_note * 100)
return(sicknotes)
}
miss_covid20 <- miss_raw(covid20, "COVID2020")
View(miss_covid20)
missing_all <- rbind(miss_raw(covid20, "COVID2020"),
miss_raw(covid21, "COVID2021"),
miss_raw(pneumo19, "Pneumo2019"),
miss_raw(gen19, "General2019"),
miss_raw(gen20, "General2020"),
miss_raw(gen21, "General2021"))
library(data.table)
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
covid21 <- fread(here::here("output", "cohorts", "input_covid_2021.csv.gz"))
pneumo19 <- fread(here::here("output", "cohorts", "input_pneumonia_2019.csv.gz"))
gen19 <- fread(here::here("output", "cohorts", "input_matched_2019.csv.gz"))
gen20 <- fread(here::here("output", "cohorts", "input_matched_2020.csv.gz"))
gen21 <- fread(here::here("output", "cohorts", "input_matched_2021.csv.gz"))
miss_raw <- function(data, name) {
sicknote1  <- data %>%
subset(!is.na(sick_note_1_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_1_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_1_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_1_duration_months)),
group = name, var = 1) %>%
distinct()
sicknote2  <- data %>%
subset(!is.na(sick_note_2_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_2_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_2_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_2_duration_months)),
group = name, var = 2) %>%
distinct()
sicknote3  <- data %>%
subset(!is.na(sick_note_3_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_3_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_3_duration_weeks)),
notmiss_dur_mos=  sum(!is.na(sick_note_3_duration_months)),
group = name, var = 3) %>%
distinct()
sicknote4  <- data %>%
subset(!is.na(sick_note_4_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_4_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_4_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_4_duration_months)),
group = name, var = 4) %>%
distinct()
sicknote5 <- data %>%
subset(!is.na(sick_note_5_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(!is.na(sick_note_5_duration_days)),
notmiss_dur_weeks = sum(!is.na(sick_note_5_duration_weeks)),
notmiss_dur_mos = sum(!is.na(sick_note_5_duration_months)),
group = name, var = 5) %>%
distinct()
sicknotes <- rbind(sicknote1, sicknote2, sicknote3, sicknote4, sicknote5) %>%
mutate(pcent_dur_days = notmiss_dur_days / n_sick_note * 100,
pcent_dur_weeks = notmiss_dur_weeks / n_sick_note * 100,
pcent_dur_mos = notmiss_dur_mos / n_sick_note * 100)
return(sicknotes)
}
missing_all <- rbind(miss_raw(covid20, "COVID2020"),
miss_raw(covid21, "COVID2021"),
miss_raw(pneumo19, "Pneumo2019"),
miss_raw(gen19, "General2019"),
miss_raw(gen20, "General2020"),
miss_raw(gen21, "General2021"))
View(missing_all)
View(missing_all)
library(data.table)
covid20 <- fread(here::here("output", "cohorts", "input_covid_2020.csv.gz"))
covid21 <- fread(here::here("output", "cohorts", "input_covid_2021.csv.gz"))
pneumo19 <- fread(here::here("output", "cohorts", "input_pneumonia_2019.csv.gz"))
gen19 <- fread(here::here("output", "cohorts", "input_matched_2019.csv.gz"))
gen20 <- fread(here::here("output", "cohorts", "input_matched_2020.csv.gz"))
gen21 <- fread(here::here("output", "cohorts", "input_matched_2021.csv.gz"))
miss_raw <- function(data, name) {
sicknote1  <- data %>%
subset(!is.na(sick_note_1_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(sick_note_1_duration_days>0),
notmiss_dur_weeks = sum(sick_note_1_duration_weeks>0),
notmiss_dur_mos = sum(sick_note_1_duration_months>0),
group = name, var = 1) %>%
distinct()
sicknote2  <- data %>%
subset(!is.na(sick_note_2_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(sick_note_2_duration_days>0),
notmiss_dur_weeks = sum(sick_note_2_duration_weeks>0),
notmiss_dur_mos = sum(sick_note_2_duration_months>0),
group = name, var = 2) %>%
distinct()
sicknote3  <- data %>%
subset(!is.na(sick_note_3_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(sick_note_3_duration_days>0),
notmiss_dur_weeks = sum(sick_note_3_duration_weeks>0),
notmiss_dur_mos=  sum(sick_note_3_duration_months>0),
group = name, var = 3) %>%
distinct()
sicknote4  <- data %>%
subset(!is.na(sick_note_4_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(sick_note_4_duration_days>0),
notmiss_dur_weeks = sum(sick_note_4_duration_weeks>0),
notmiss_dur_mos = sum(sick_note_4_duration_months>0),
group = name, var = 4) %>%
distinct()
sicknote5 <- data %>%
subset(!is.na(sick_note_5_date)) %>%
transmute( n_sick_note = n(),
notmiss_dur_days = sum(sick_note_5_duration_days>0),
notmiss_dur_weeks = sum(sick_note_5_duration_weeks>0),
notmiss_dur_mos = sum(sick_note_5_duration_months>0),
group = name, var = 5) %>%
distinct()
sicknotes <- rbind(sicknote1, sicknote2, sicknote3, sicknote4, sicknote5) %>%
mutate(pcent_dur_days = notmiss_dur_days / n_sick_note * 100,
pcent_dur_weeks = notmiss_dur_weeks / n_sick_note * 100,
pcent_dur_mos = notmiss_dur_mos / n_sick_note * 100)
return(sicknotes)
}
missing_all <- rbind(miss_raw(covid20, "COVID2020"),
miss_raw(covid21, "COVID2021"),
miss_raw(pneumo19, "Pneumo2019"),
miss_raw(gen19, "General2019"),
miss_raw(gen20, "General2020"),
miss_raw(gen21, "General2021"))
write.csv(missing_all, here::here("output", "tabfig", "sick_note_missing_raw.csv"),
row.names = FALSE)
