sex,
region,
imdq10,
ethnicity) %>%
tbl_summary(by = opioid_any) %>%
add_overall()
table_new2 <- select(subset(table,time=="After"),
opioid_new,
age_cat,
sex,
region,
imdq10,
ethnicity) %>%
tbl_summary(by = opioid_new)
table_after <- tbl_merge(tbls = list(table_prev2, table_new2),
tab_spanner = c("**Any opioid prescribing**", "**New opioid prescribing**"))
table_after
library(xfun)
dir_create()
?dir_create
library(fs)
library(tidyverse)
library(forecast)
ome <- read.csv(file = 'G:/Shared drives/OpenSAFELY/Research/Opioids/Curtis 2019 analysis/Prescribing of opioids total oral morphine equivalence (1).csv')
ome.ts <- ts(ome$ratio, start=c(2017,5), frequency=12)
plot(ome.ts)
time <- seq(1,length(ome.ts))
time
step <- ifelse(time<35,0,1)
step
season <- seasonaldummy(ome.ts)
mod <- lm(ome.ts ~ time + step + season)
summary(mod)
plot(mod)
summary(mod2)
item <- read.csv(file = 'C:/Users\aschaffer/OneDrive - Nexus365/Desktop/New folder/items for opioid analgesics per.csv')
item <- read.csv(file = 'C:/Users/aschaffer/OneDrive - Nexus365/Desktop/New folder/items for opioid analgesics per.csv')
View(item)
item2 <- item %>%
group_by(date) %>%
summarise(y = sum(y_items))
View(item2)
item.ts <- ts(item2$y, start=c(2018,1), frequency=12)
plot(item.ts)
View(ome)
library(ggplot2)
ggplot() +
geom_line(item2, aes(x=date, y=y))
library(ggplot2)
ggplot(item2) +
geom_line(aes(x=date, y=y))
item2 %>% item2 %>% mutate(date = as.Date(as.character(date), format = "%Y-%m-%d")
item2 <- item2 %>% mutate(date = as.Date(as.character(date), format = "%Y-%m-%d")
item2 <-  item2 %>%
mutate(date = as.Date(as.character(date), format = "%Y-%m-%d")
)
library(ggplot2)
ggplot(item2) +
geom_line(aes(x=date, y=y))
View(item2)
item2 <- item %>%
group_by(date) %>%
summarise(y = sum(y_items))
item2 <-  item2 %>%
mutate(date = as.Date(as.character(date), format = "%Y-%m-%d"))
View(item2)
item2 <- item %>%
group_by(date) %>%
summarise(y = sum(y_items)) %>%
mutate(date = as.Date(as.character(date), format = "%Y-%m-%d"))
item2 <- item %>%
group_by(date) %>%
summarise(y = sum(y_items)) %>%
mutate(date = as.Date(date, format = "%Y-%m-%d"))
item <- read.csv(file = 'C:/Users/aschaffer/OneDrive - Nexus365/Desktop/New folder/items for opioid analgesics per.csv') %>%
mutate(date = as.Date(date, format = "%Y-%m-%d"))
item <- read.csv(file = 'C:/Users/aschaffer/OneDrive - Nexus365/Desktop/New folder/items for opioid analgesics per.csv')
item2 <- item %>%
group_by(date) %>%
summarise(y = sum(y_items))
class(item2)
class(item2$date)
item <- read.csv(file = 'C:/Users/aschaffer/OneDrive - Nexus365/Desktop/New folder/items for opioid analgesics per.csv')
item2 <- item %>%
group_by(date) %>%
summarise(y = sum(y_items)) %>%
mutate(date2 = as.Date(date), format = "%d-%m-%Y")
library(ggplot2)
ggplot(item2) +
geom_line(aes(x=date, y=y))
item <- read.csv(file = 'C:/Users/aschaffer/OneDrive - Nexus365/Desktop/New folder/items for opioid analgesics per.csv')
item2 <- item %>%
group_by(date) %>%
summarise(y = sum(y_items)) %>%
mutate(date = as.Date(as.character(date), format = "%d-%m-%Y"))
item <- read.csv(file = 'C:/Users/aschaffer/OneDrive - Nexus365/Desktop/New folder/items for opioid analgesics per.csv')
item2 <- item %>%
group_by(date) %>%
summarise(y = sum(y_items)) %>%
mutate(date = as.Date(date, format = "%d-%m-%Y"))
item <- read.csv(file = 'C:/Users/aschaffer/OneDrive - Nexus365/Desktop/New folder/items for opioid analgesics per.csv')
item2 <- item %>%
group_by(date) %>%
summarise(y = sum(y_items)) %>%
mutate(date = as.Date(date, format = "%d/%m/%Y"))
library(ggplot2)
ggplot(item2) +
geom_line(aes(x=date, y=y))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
scale_y_continuous(limits = c(1500000,2500000)) +
theme_bw()
library(ggplot2)
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
scale_y_continuous(limits = c(1500000,2250000)) +
theme_bw()
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01"))) +
scale_y_continuous(limits = c(1500000,2250000)) +
theme_bw()
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
theme_bw()
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
theme_bw() +
theme(panel.grid.major.y = element_line(col = "gray70"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
theme_bw() +
theme(panel.grid.major.y = element_line())
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line())
library(ggplot2)
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(colour = "gray70"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(colour = "gray95"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(colour = "gray95"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(fill = "gray95"))
?panel.grid.major.y
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major = element_line(colour = "gray95"))
library(ggplot2)
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.x = element_line(colour = "gray95"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.background = element_rect(fill="black"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(col = "gray90"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(color = "gray90"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(color = "gray80"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash",
col = "firetruck3") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(color = "gray80"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash",
col = "firebrick3") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(color = "gray80"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3") +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash",
col = "firebrick3") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash",
col = "firebrick3") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash",
col = "firebrick3") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(color = "gray80"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3", width =2) +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash",
col = "firebrick3") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash",
col = "firebrick3") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash",
col = "firebrick3") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(color = "gray80"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3", line =2) +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash",
col = "firebrick3") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash",
col = "firebrick3") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash",
col = "firebrick3") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(color = "gray80"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3", size = 1.5) +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash",
col = "firebrick3") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash",
col = "firebrick3") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash",
col = "firebrick3") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(color = "gray80"))
ggplot(item2) +
geom_line(aes(x=date, y=y), col = "dodgerblue3", size = 1.0) +
geom_vline(aes(xintercept = as.Date("2020-03-01")), linetype = "longdash",
col = "firebrick3") +
geom_vline(aes(xintercept = as.Date("2020-11-01")), linetype = "longdash",
col = "firebrick3") +
geom_vline(aes(xintercept = as.Date("2021-01-01")), linetype = "longdash",
col = "firebrick3") +
scale_y_continuous(limits = c(1500000,2250000)) +
ylab("No. items") + xlab("Month") +
theme_bw() +
theme(panel.grid.major.y = element_line(color = "gray80"))
library(forecast)
tmp <- read.csv2("C:\Users\aschaffer\OneDrive - Nexus365\Documents\GitHub\opioids-covid-research\output\released_outputs")
library(readr)
tmp <- read.csv2("C:/Users/aschaffer/OneDrive - Nexus365/Documents/GitHub/opioids-covid-research/output/released_outputs")
tmp <- read.csv2("C:/Users/aschaffer/OneDrive - Nexus365/Desktop/ts_full_overall.csv")
tmp <- read.csv2("C:/Users/aschaffer/OneDrive - Nexus365/Desktop/ts_prev_full_overall.csv")
View(tmp)
tmp <- read.csv2("C:/Users/aschaffer/OneDrive - Nexus365/Desktop/ts_prev_full_bygroup.csv")
flu_vax_sum <- read_delim("C:\Users\aschaffer\OneDrive - Nexus365\Documents\Released outputs\vax-fourth-dose-rd\release16JAN2023"),
flu_vax_sum <- read_delim("C:/Users/aschaffer/OneDrive - Nexus365/Documents/Released outputs/vax-fourth-dose-rd/release16JAN2023"),
flu_vax_sum <- read_delim("C:/Users/aschaffer/OneDrive - Nexus365/Documents/Released outputs/vax-fourth-dose-rd/release16JAN2023",
delim = ";")
library('tidyverse')
library('lubridate')
library('arrow')
library('here')
library('reshape2')
library('dplyr')
library('fs')
library('ggplot2')
library('RColorBrewer')
flu_vax_sum <- read_delim("C:/Users/aschaffer/OneDrive - Nexus365/Documents/Released outputs/vax-fourth-dose-rd/release16JAN2023",
delim = ";")
flu_vax_sum <- read_delim("C:/Users/aschaffer/OneDrive - Nexus365/Documents/Released outputs/vax-fourth-dose-rd/release16JAN2023/flu_vax_by_week.csv",
delim = ";")
View(flu_vax_sum)
ggplot(subset(flu_vax_sum, (age > 45 & age < 54))) +
geom_line(aes(x = week, y = rate, group = age, col = age),
size = 1.25) +
scale_color_brewer(palette = "RdBu") +
scale_y_continuous(limits = c(0, 100)) +
scale_x_continuous(breaks = c(as.Date("2022-10-02"),
as.Date("2022-10-23"),
as.Date("2022-11-13"),
as.Date("2022-12-04"),
as.Date("2022-12-24")),
labels = c("Oct 2", "Oct 23", "Nov 13", "Dec 4", "Dec 24")) +
xlab(NULL) + ylab("No. vaccinated (%)") +
theme_bw() +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
strip.background = element_blank(),
strip.text = element_text(hjust = 0),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1))
flu_vax_sum <- read_delim("C:/Users/aschaffer/OneDrive - Nexus365/Documents/Released outputs/vax-fourth-dose-rd/release16JAN2023/flu_vax_by_week.csv",
delim = ";") %>%
mutate(date = col_date(format="%Y-%m-%d"))
flu_vax_sum <- read_delim("C:/Users/aschaffer/OneDrive - Nexus365/Documents/Released outputs/vax-fourth-dose-rd/release16JAN2023/flu_vax_by_week.csv",
delim = ";") %>%
mutate(date = as.Date(format="%Y-%m-%d"))
flu_vax_sum <- read_delim("C:/Users/aschaffer/OneDrive - Nexus365/Documents/Released outputs/vax-fourth-dose-rd/release16JAN2023/flu_vax_by_week.csv",
delim = ";") %>%
mutate(week= as.Date(format="%Y-%m-%d"))
flu_vax_sum <- read_delim("C:/Users/aschaffer/OneDrive - Nexus365/Documents/Released outputs/vax-fourth-dose-rd/release16JAN2023/flu_vax_by_week.csv",
delim = ";") %>%
mutate(week= as.Date(week,format="%Y-%m-%d"))
ggplot(subset(flu_vax_sum, (age > 45 & age < 54))) +
geom_line(aes(x = week, y = rate, group = age, col = age),
size = 1.25) +
scale_color_brewer(palette = "RdBu") +
scale_y_continuous(limits = c(0, 100)) +
scale_x_continuous(breaks = c(as.Date("2022-10-02"),
as.Date("2022-10-23"),
as.Date("2022-11-13"),
as.Date("2022-12-04"),
as.Date("2022-12-24")),
labels = c("Oct 2", "Oct 23", "Nov 13", "Dec 4", "Dec 24")) +
xlab(NULL) + ylab("No. vaccinated (%)") +
theme_bw() +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
strip.background = element_blank(),
strip.text = element_text(hjust = 0),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1))
class(flu_vax_sum$age)
class(flu_vax_sum$rate)
ggplot(subset(flu_vax_sum, (age > 45 & age < 54))) +
geom_line(aes(x = week, y = rate, group = age, col = age),
size = 1.25) +
scale_color_brewer(palette = "RdBu") +
scale_y_continuous(limits = c(0, 100))
ggplot(subset(flu_vax_sum, (age > 45 & age < 54))) +
geom_line(aes(x = week, y = rate, group = age, col = age),
size = 1.25)
ggplot(subset(flu_vax_sum, (age > 45 & age < 54))) +
geom_line(aes(x = week, y = rate, group = age, col = age),
size = 1.25) +
scale_color_brewer(palette = "RdBu") +
scale_y_continuous(limits = c(0, 100))
class(flu_vax_sum$rate)
ggplot(subset(flu_vax_sum, (age > 45 & age < 54))) +
geom_line(aes(x = week, y = rate, group = age, col = age),
size = 1.25) +
scale_color_brewer(palette = "RdBu") +
scale_x_continuous(breaks = c(as.Date("2022-10-02"),
as.Date("2022-10-23"),
as.Date("2022-11-13"),
as.Date("2022-12-04"),
as.Date("2022-12-24")),
labels = c("Oct 2", "Oct 23", "Nov 13", "Dec 4", "Dec 24")) +
xlab(NULL) + ylab("No. vaccinated (%)") +
theme_bw() +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
strip.background = element_blank(),
strip.text = element_text(hjust = 0),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(subset(flu_vax_sum, (age > 45 & age < 54))) +
geom_line(aes(x = week, y = rate, group = age, col = age),
size = 1.25) +
scale_color_brewer(palette = "RdBu") +
scale_y_continuous(limits = c(0, 100)) +
scale_x_continuous(breaks = c(as.Date("2022-10-02"),
as.Date("2022-10-23"),
as.Date("2022-11-13"),
as.Date("2022-12-04"),
as.Date("2022-12-24")),
labels = c("Oct 2", "Oct 23", "Nov 13", "Dec 4", "Dec 24"))
ggplot(subset(flu_vax_sum, (age > 45 & age < 54))) +
geom_line(aes(x = week, y = rate, group = age, col = age),
size = 1.25) +
scale_color_brewer(palette = "RdBu") +
scale_x_continuous(breaks = c(as.Date("2022-10-02"),
as.Date("2022-10-23"),
as.Date("2022-11-13"),
as.Date("2022-12-04"),
as.Date("2022-12-24")),
labels = c("Oct 2", "Oct 23", "Nov 13", "Dec 4", "Dec 24"))
?scale_color_brewer
flu_vax_sum <- read_delim("C:/Users/aschaffer/OneDrive - Nexus365/Documents/Released outputs/vax-fourth-dose-rd/release16JAN2023/flu_vax_by_week.csv",
delim = ";") %>%
mutate(week= as.Date(week,format="%Y-%m-%d"), age = as.character(age))
# Plots
#######################################
ggplot(flu_vax_sum) +
geom_line(aes(x = week, y = rate, group = age, col = age),
size = 1.25) +
scale_color_brewer(palette = "RdBu") +
scale_y_continuous(limits = c(0, 100)) +
scale_x_continuous(breaks = c(as.Date("2022-10-02"),
as.Date("2022-10-23"),
as.Date("2022-11-13"),
as.Date("2022-12-04"),
as.Date("2022-12-24")),
labels = c("Oct 2", "Oct 23", "Nov 13", "Dec 4", "Dec 24")) +
xlab(NULL) + ylab("No. vaccinated (%)") +
theme_bw() +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
strip.background = element_blank(),
strip.text = element_text(hjust = 0),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(flu_vax_sum) +
geom_line(aes(x = week, y = rate, group = age, col = age),
size = 1.25) +
scale_color_brewer(palette = "RdBu") +
scale_y_continuous(limits = c(0, 50)) +
scale_x_continuous(breaks = c(as.Date("2022-10-02"),
as.Date("2022-10-23"),
as.Date("2022-11-13"),
as.Date("2022-12-04"),
as.Date("2022-12-24")),
labels = c("Oct 2", "Oct 23", "Nov 13", "Dec 4", "Dec 24")) +
xlab(NULL) + ylab("No. vaccinated (%)") +
theme_bw() +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
strip.background = element_blank(),
strip.text = element_text(hjust = 0),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1))
ggsave(here::here("output", "cumulative_rates", "plot_flu_vax_byage.png"),
dpi = 300, units = "in", width = 6, height = 3.25)
ggsave("C:/Users/aschaffer/OneDrive - Nexus365/Documents/Released outputs/vax-fourth-dose-rd/release16JAN2023/plot_flu_vax_byage.png"),
ggsave("C:/Users/aschaffer/OneDrive - Nexus365/Documents/Released outputs/vax-fourth-dose-rd/release16JAN2023/plot_flu_vax_byage.png",
dpi = 300, units = "in", width = 6, height = 3.25)
setwd("C:/Users/aschaffer/OneDrive - Nexus365/Documents/GitHub/long-covid-sick-notes")
library(haven)
library(tidyverse)
library(reshape2)
library(tools)
library(here)
library(fs)
library(RColorBrewer)
library(readr)
detach("package:here", unload = TRUE)
library(here)
## Create directories if needed
dir_create(here::here("output", "tabfig"), showWarnings = FALSE, recurse = TRUE)
dir_create(here::here("output", "cohorts"), showWarnings = FALSE, recurse = TRUE)
covid20 <- read_csv(here::here("output", "cohorts", "input_covid_2020_with_duration.csv"))
View(covid20)
View(covid20)
